# Тестирование REST API</h1>
### Метод GET /products/{productId}/status?authToken=&recalculate=&owner=&region=

### Цели:
Проверить:
- авторизацию по authToken
- обработку productId
- обработку необязательных параметров
- корректность кодов ответов
- корректность тела ответа JSON и допустимых значений

### Входные данные:
- productId (обязательный)
- authToken (обязательный)
- recalculate
- owner
- region

### Выходные данные

**1. При успешном ответе:**

Код: 200

Тело в формате json: { "productStatus": status }

Допустимые значения status:
- 1
- 0

**2. Если продукт не найден**

Код: 404

**3. При неверном или отсутствующем токене**

Код: 401

**4. При ошибке**

Код: 500

Тело в формате json: {"errorMessage": }


### Критерии завершения
- пройдены позитивные, негативные, пограничные тесты по каждому параметру и их независимым комбинациям
- подтверждены коды ошибок и формат сообщений об ошибках

### Инструменты тестирования
- Postman / Insomnia — ручное тестирование REST API
- curl — проверка запросов через командную строку
- Swagger / OpenAPI (при наличии) — анализ спецификации
- Логи приложения — анализ причин ошибок (500)
- База данных (тестовый контур) — проверка изменений статусов продукта

### Вопросы и допущения

- Допустимо ли передавать authToken в открытом виде в URL, учитывая риски утечек?

## Тест кейсы

### 1. Авторизация
**Тест-кейс 1: Получение статуса продукта при валидном authToken и существующем продукте**

Предусловия:
- Пользователь авторизован и имеет действующий токен аутентификации
- Токен аутентификации получен и будет передан в параметр запроса authToken
- Существует валидный productId существующего продукта

Шаги:
- Установить в параметре запроса authToken валидное значение (16 символов, буквы и цифры)
- Отправить GET-запрос на эндпоинт /products/{productId}/status

Постусловия:
- Получен ответ со статусом 200
- Ответ возвращён в формате JSON
- В теле ответа присутствует поле productStatus со значением 0 или 1

**Тест-кейс 2: Получение статуса продукта без передачи authToken**

Предусловия:
- Существует валидный productId существующего продукта

Шаги:
- Не передавать параметр authToken.
- Отправить GET-запрос на эндпоинт /products/{productId}/status

Постусловия:
- Получен ответ со статусом 401

**Тест-кейс 3: Получение статуса продукта с authToken неверной длины**

Предусловия:
- Существует валидный productId существующего продукта.

Шаги:
- Установить в параметре authToken значение длиной менее 16 символов
- Отправить GET-запрос на эндпоинт /products/{productId}/status

Постусловия:
- Получен ответ со статусом 401

**Тест-кейс 4: Получение статуса продукта с authToken, содержащим недопустимые символы**

Предусловия:
- Существует валидный productId существующего продукта

Шаги:
- Установить в параметре authToken значение, содержащее спецсимволы
- Отправить GET-запрос на эндпоинт /{productId}/status

Постусловия:
- Получен ответ со статусом 401

### 2. productId
**Тест-кейс 5: Получение статуса несуществующего продукта**

Предусловия:
- Пользователь авторизован и имеет действующий токен аутентификации
- Известен productId, отсутствующий в системе

Шаги:
- Передать валидный authToken.
- Отправить GET-запрос на эндпоинт `/products/{productId}/status` с несуществующим productId

Постусловия:
- Получен ответ со статусом 404.

### 3. Необязательные параметры
**Тест-кейс 6: Получение статуса продукта без необязательных параметров**

Предусловия:
- Пользователь авторизован и имеет действующий токен аутентификации
- Существует валидный productId существующего продукта.

Шаги:
- Передать валидный authToken.
- Не передавать параметры recalculate, owner, region.
- Отправить GET-запрос на эндпоинт `/products/{productId}/status`.

Постусловия:
- Получен ответ со статусом 200.

**Тест-кейс 7: Получение статуса продукта при recalculate=true**

Предусловия:
- Пользователь авторизован и имеет действующий токен аутентификации
- Существует валидный productId существующего продукта.

Шаги:
- Передать валидный authToken.
- В параметре запроса recalculate установить значение `true`.
- Отправить GET-запрос на эндпоинт `/products/{productId}/status`.

Постусловия:
- Получен ответ со статусом 200.

**Тест-кейс 8: Получение статуса продукта при recalculate=false**

Предусловия:
- Пользователь авторизован и имеет действующий токен аутентификации.
- Существует валидный productId существующего продукта

Шаги:
- В параметре запроса authToken установить валидное значение
- В параметре запроса recalculate установить значение `false`.
- Отправить GET-запрос на эндпоинт `/products/{productId}/status`

Постусловия:
- Получен ответ со статусом 200.


**Тест-кейс 9: Получение статуса продукта при owner=Создатель**

Предусловия:
- Пользователь авторизован и имеет действующий токен аутентификации.
- Существует валидный productId существующего продукта.

Шаги:
- В параметре запроса authToken установить валидное значение.
- В параметре запроса owner установить значение `Создатель`.
- Отправить GET-запрос на эндпоинт `/products/{productId}/status`.

Постусловия:
- Получен ответ со статусом 200.

**Тест-кейс 10: Получение статуса продукта при owner=Пользователь**

Предусловия:
- Пользователь авторизован и имеет действующий токен аутентификации.
- Существует валидный productId существующего продукта.

Шаги:
- В параметре запроса authToken установить валидное значение
- В параметре запроса owner установить значение `Пользователь`
- Отправить GET-запрос на эндпоинт `/products/{productId}/status`

Постусловия:
- Получен ответ со статусом 200

**Тест-кейс 11: Получение статуса продукта при валидном значении region**

Предусловия:
- Пользователь авторизован и имеет действующий токен аутентификации
- Существует валидный productId существующего продукта

Шаги:
- В параметре запроса authToken установить валидное значение.
- В параметре запроса region установить одно из валидных значений: `Северо-Запад`, `Сибирь`, `Поволжье`
- Отправить GET-запрос на эндпоинт `/products/{productId}/status`
Постусловия:
- Получен ответ со статусом 200

**Тест-кейс 12: Получение статуса продукта при задании всех необязательных параметров**

Предусловия:
- Пользователь авторизован и имеет действующий токен аутентификации
- Существует валидный productId существующего продукта

Шаги:
- В параметре запроса authToken установить валидное значение
- В параметре запроса recalculate установить значение `false`
- В параметре запроса owner установить значение `Пользователь`
- В параметре запроса region установить значение `Сибирь`
- Отправить GET-запрос на эндпоинт `/products/{productId}/status`

Постусловия:
- Получен ответ со статусом 200

### 4. Невалидные значения параметров
**Тест-кейс 13: Получение статуса продукта при невалидном значении recalculate**

Предусловия:
- Пользователь авторизован и имеет действующий токен аутентификации
- Существует валидный productId существующего продукта

Шаги:
- В параметре запроса authToken установить валидное значение
- В параметре запроса recalculate установить значение `abc`
- Отправить GET-запрос на эндпоинт `/products/{productId}/status`

Постусловия:
- Получен ответ со статусом 500
- Ответ возвращён в формате JSON
- В теле ответа присутствует поле `errorMessage`

**Тест-кейс 14: Получение статуса продукта при невалидном значении owner**

Предусловия:
- Пользователь авторизован и имеет действующий токен аутентификации
- Существует валидный productId существующего продукта

Шаги:
- В параметре запроса authToken установить валидное значение
- В параметре запроса owner установить значение `Администратор`
- Отправить GET-запрос на эндпоинт `/products/{productId}/status`

Постусловия
- Получен ответ со статусом 500
- Ответ содержит поле `errorMessage`

**Тест-кейс 15: Получение статуса продукта при невалидном значении region**

Предусловия:
- Пользователь авторизован и имеет действующий токен аутентификации
- Существует валидный productId существующего продукта

Шаги:
- В параметре запроса authToken установить валидное значение
- В параметре запроса region установить значение `Урал`
- Отправить GET-запрос на эндпоинт `/products/{productId}/status`

Постусловия:
- Получен ответ со статусом 500
- Ответ содержит поле `errorMessage`

### 5. Обработка ошибок

**Тест-кейс 16: Получение статуса продукта при внутренней ошибке сервера**

Предусловия:
- Пользователь авторизован и имеет действующий токен аутентификации
- Существует валидный productId существующего продукта
- База данных сервиса недоступна (например, остановлен контейнер БД)

Шаги:
- В параметре запроса authToken установить валидное значение
- Отправить GET-запрос на эндпоинт `/products/{productId}/status`

Постусловия:
- Получен ответ со статусом 500.
- Ответ возвращён в формате JSON.
- В теле ответа присутствует поле `errorMessage`.

### 6.Проверка безопасности
**Тест-кейс 17: Попытка SQL-инъекции через productId**

Предусловия:
- Пользователь авторизован и имеет действующий токен аутентификации

Шаги:
- В path-параметре productId указать SQL-инъекцию
- В параметре запроса authToken установить валидное значение
- Отправить GET-запрос на эндпоинт `/products/{productId}/status`

Постусловия:
- Ошибка сервера 500 отсутствует
- Получен ответ со статусом 400 или 404

**Тест-кейс 18: Попытка SQL-инъекции через query-параметры**

Предусловия:
- Пользователь авторизован и имеет действующий токен аутентификации
- Существует валидный productId существующего продукта

Шаги:
- В параметре запроса authToken установить валидное значение
- В параметре запроса owner указать SQL-инъекцию
- Отправить GET-запрос на эндпоинт `/products/{productId}/status`

Постусловия:
- Утечка данных отсутствует
- Ошибка сервера 500 отсутствует либо зафиксирована согласно реализации
- Получен ответ со статусом 400 или 500