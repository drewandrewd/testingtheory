# Тестирование REST API расчёта стоимости продукта

### Метод
GET /products/{productId}/cost?authToken=&count=&start=


## Цели
Проверить:
- авторизацию по authToken
- обработку productId
- обработку обязательных параметров count и start
- корректность расчёта стоимости продукта
- корректность кодов HTTP-ответов
- корректность формата тела ответа JSON

## Входные данные
- productId (обязательный)
- authToken (обязательный, 16 символов, буквы и цифры)
- count - количество приобретаемых экземпляров (обязательный)
- start - количество ранее приобретённых экземпляров (обязательный)

## Выходные данные

### 1. При успешном ответе
Код: 200

Тело в формате JSON:  
`{ "cost": 100 }`


### 2. Если продукт не найден
Код: 404

### 3. При неверном или отсутствующем токене
Код: 401


### 4. При внутренней ошибке
Код: **500**

Тело в формате JSON:  
{ "errorMessage": "" }


## Критерии завершения
- пройдены позитивные, негативные и пограничные проверки по каждому параметру
- подтверждена корректность расчёта стоимости
- подтверждены коды ошибок и формат сообщений об ошибках

## Инструменты тестирования
- Postman / Insomnia — ручное тестирование REST API
- curl — проверка запросов через командную строку
- Swagger / OpenAPI (при наличии) — анализ спецификации API
- Логи приложения — анализ причин ошибок (500)
- Тестовая база данных — проверка наличия продукта


## Вопросы и допущения
- Как именно трактуется правило партиями по 5: повтор таблицы цен или иное поведение?
- Предусмотрен ли HTTP-код 400 при некорректных параметрах count и start?
- Допустимо ли передавать authToken в URL с точки зрения безопасности?


## Тест-кейсы

### 1. Авторизация

**Тест-кейс 1: Расчёт стоимости при валидном authToken и существующем продукте**

Предусловия:
- Пользователь имеет действующий authToken
- Существует валидный productId

Шаги:
- Передать валидный authToken
- Передать count=5, start=0
- Отправить GET-запрос /products/{productId}/cost
- Проверить статус ответа
- Проверить тело ответа

Ожидаемый результат:
- Ответ со статусом 200
- Ответ в формате JSON
- Поле cost содержит корректную стоимость

Постусловия:


**Тест-кейс 2: Запрос без передачи authToken**

Предусловия:
- Существует валидный productId

Шаги:
- Не передавать параметр authToken
- Отправить GET-запрос /products/{productId}/cost

Ожидаемый результат:
- Ответ со статусом 401

Постусловия:


**Тест-кейс 3: Запрос с authToken неверной длины**

Предусловия:
- Существует валидный productId

Шаги:
- Передать authToke` длиной менее 16 символов
- Отправить GET-запрос /products/{productId}/cost

Ожидаемый результат:
- Ответ со статусом 401

Постусловия:


### 2. productId

**Тест-кейс 4: Запрос стоимости несуществующего продукта**

Предусловия:
- Пользователь авторизован
- Известен productId, отсутствующий в системе

Шаги:
- Передать валидный authToken
- Передать несуществующий productId
- Отправить GET-запрос

Ожидаемый результат:
- Ответ со статусом 404

Постусловия:


### 3. Расчёт стоимости

**Тест-кейс 5: Расчёт стоимости при start=0 и count=5**

Предусловия:
- Пользователь авторизован
- Существует валидный productId

Шаги:
- Передать count=5, start=0
- Отправить GET-запрос

Ожидаемый результат:
- Ответ 200
- Стоимость рассчитана как сумма цен за 1–5 экземпляры

Постусловия:


**Тест-кейс 6: Расчёт стоимости при start > 0**

Предусловия:
- Пользователь авторизован
- Существует валидный productId

Шаги:
- Передать start=2, count=2
- Отправить GET-запрос

Ожидаемый результат:
- Ответ 200
- Стоимость рассчитана для 3 и 4 экземпляров продукта

Постусловия:


**Тест-кейс 7: Расчёт стоимости при count > 5**

Предусловия:
- Пользователь авторизован
- Существует валидный productId

Шаги:
- Передать count=6, start=0
- Отправить GET-запрос

Ожидаемый результат:
- Ответ 200
- Стоимость рассчитана партиями по 5

Постусловия:


### 4. Невалидные значения параметров

**Тест-кейс 8: Передача count=0**

Предусловия:
- Пользователь авторизован
- Существует валидный productId

Шаги:
- Передать count=0
- Отправить GET-запрос

Ожидаемый результат:
- Получен ответ с ошибкой 500
- тело содержит errorMessage

Постусловия:


**Тест-кейс 9: Передача отрицательного start**

Предусловия:
- Пользователь авторизован
- Существует валидный productId

Шаги:
- Передать start=-1
- Отправить GET-запрос

Ожидаемый результат:
- Ответ с ошибкой
- Ошибка обработана корректно, без утечки данных

Постусловия:


### 5. Проверка безопасности

**Тест-кейс 10: Попытка SQL-инъекции через productId**

Предусловия:
- Пользователь авторизован

Шаги:
- В productId указать 1 OR 1=1
- Передать валидный authToken
- Отправить GET-запрос

Ожидаемый результат:
- Отсутствие ошибки 500
- Получен ответ со статусом 400 или 404

Постусловия:
